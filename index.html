<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Prep Center</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Hammer.js for swipe gestures -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- Auth Section -->
        <section id="auth-section" class="screen">
            <h1>IELTS Prep Login</h1>
            <form id="login-form">
                <input type="email" id="email" placeholder="Email" required>
                <input type="password" id="password" placeholder="Password" required>
                <button type="submit">Login</button>
            </form>
            <p id="auth-error" class="error"></p>
        </section>

        <!-- Student Dashboard -->
        <section id="student-dashboard" class="screen hidden">
            <header>
                <h2>Welcome, <span id="student-name"></span></h2>
                <button id="logout-btn">Logout</button>
            </header>
            <div id="student-info" class="card">
                <h3>Your Level: <span id="student-level">Pending</span></h3>
            </div>
            <div id="exercise-list">
                <!-- Exercises will be loaded here -->
            </div>
            <div class="card">
                <canvas id="progressChart"></canvas>
            </div>
            <button onclick="startMiniGame()">Take a Break (Game)</button>
        </section>

        <!-- Teacher Dashboard -->
        <section id="teacher-dashboard" class="screen hidden">
            <header>
                <h2>Teacher Panel</h2>
                <button id="teacher-logout-btn">Logout</button>
            </header>
            
            <div class="card">
                <h3>Controls</h3>
                <button id="unlock-all-btn">Unlock Exercises</button>
                <button id="speaking-session-btn">Start Speaking Session</button>
            </div>

            <div id="student-submissions" class="card">
                <h3>Writing Submissions</h3>
                <div id="submissions-list"></div>
            </div>

            <div id="student-progress-list" class="card">
                <h3>Student List</h3>
                <!-- Student progress will be shown here -->
            </div>
        </section>

        <!-- Exercise Screen -->
        <section id="exercise-screen" class="screen hidden">
            <div id="timer-display">00:00</div>
            
            <!-- Reading -->
            <div id="reading-container" class="swipe-container hidden">
                <div id="passage" class="swipe-panel"></div>
                <div id="questions" class="swipe-panel"></div>
            </div>

            <!-- Listening -->
            <div id="listening-container" class="card hidden">
                <p><strong>Listening Test:</strong> Answer based on the transcript read by the teacher.</p>
                <div id="listening-questions"></div>
            </div>

            <!-- Writing -->
            <div id="writing-container" class="card hidden">
                <h3 id="writing-prompt-title">Writing Task</h3>
                <p id="writing-prompt"></p>
                <textarea id="writing-input" rows="10" placeholder="Type your essay here..."></textarea>
                <button id="submit-writing">Submit Answer</button>
            </div>

            <button id="back-to-dash">Back to Dashboard</button>
        </section>

        <!-- Speaking Session Overlay -->
        <div id="speaking-overlay" class="screen hidden">
            <h2>Speaking Evaluation</h2>
            <div id="active-student">Student: <span id="speaking-student-name">-</span></div>
            <div id="speaking-timer">00:00</div>
            <div class="controls">
                <button onclick="toggleSpeakingTimer()">Start/Pause</button>
                <button onclick="closeSpeakingSession()">End Session</button>
            </div>
            <div class="criteria">
                <p>Fluency | Lexical | Grammar | Pronunciation</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/supabase-config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/exercises.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/game.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
